/* http://closure-compiler.appspot.com/ */
function monthAbbrToNum(a,b=false){var c;if(/[A-Z]{3}/i.test(a))switch(a.toLowerCase()){case"jan":c=1;break;case"feb":c=2;break;case"mar":c=3;break;case"apr":c=4;break;case"may":c=5;break;case"jun":c=6;break;case"jul":c=7;break;case"aug":c=8;break;case"sep":c=9;break;case"oct":c=10;break;case"nov":c=11;break;case"dec":c=12;break;default:c="Error in function monthAbbrToNum: "+a+"not recognized as a valid month."}else c="Error in function monthAbbrToNum: input received did not match expected format /[A-Z]{3}/.\n(/[A-Z]{3}/i.test("+a+") returned false.)";return"string"==typeof c?(window.alert("function monthAbbrToNum("+a+", "+b+") is outputting "+c+", which is a string (vice a number). "),c):"number"==typeof c?b?c-1:c:void 0}function numToMonAbbr(a,b=false){var c;if(/\d+/i.test(a))switch(b&&(a+=1),a){case 1:c="JAN";break;case 2:c="FEB";break;case 3:c="MAR";break;case 4:c="APR";break;case 5:c="MAY";break;case 6:c="JUN";break;case 7:c="JUL";break;case 8:c="AUG";break;case 9:c="SEP";break;case 10:c="OCT";break;case 11:c="NOV";break;case 12:c="DEC";break;default:c="Error in function numToMonAbbr: "+a+"not recognized as a valid month."}else c="Error in function monthAbbrToNum: input received did not match expected format /d+/i.\n(/d+/i.test("+a+") returned false.)";return c}function NOW_MINUS_ONE_WEEK(){return new Date(Date.now().valueOf()+864e5)}function makeDate(a){var b,c,d;return b=parseInt(a.replace(/<td class="due">(\d\d) ([A-Z]{3}) (\d\d)<\/td>/i,"$1")),c=monthAbbrToNum(a.replace(/<td class="due">(\d\d) ([A-Z]{3}) (\d\d)<\/td>/i,"$2"),!0),d=parseInt(a.replace(/<td class="due">(\d\d) ([A-Z]{3}) (\d\d)<\/td>/i,"$3"))+2e3,new Date(d,c,b)}function colorize(a){var b=a.replace(/<td class="due">(\d\d) ([A-Z]{3}) (\d\d)<\/td>/gi,function(a){var b=makeDate(a),c=b.getDate()+" "+numToMonAbbr(b.getMonth(),!0)+" "+b.getFullYear();return c=c.replace(/(\d+ [A-Z]{3} )\d\d(\d\d)/i,"$1$2"),c=c.replace(/^\d [A-Z]{3} \d\d/i,"0$&"),b<=Date.now()?'<td style="color:red">'+c+"</td>":b<=NOW_MINUS_ONE_WEEK()?'<td style="color:Gold">'+c+"</td>":"<td>"+c+"</td>"});return b}function printAll(a){for(var b,c,d,e,f=["ACBT","PREC APP","A/R DAY","SEPT","DAY LANDING","FORM LNDG"],g="",h=a.match(/NAME: ([A-Z]+) ?,[^]*NAME: \1[^]*?PAGE/gi),i=0;i<h.length;i++){e=h[i].replace(/NAME: ([A-Z]+) ?,[^]*NAME: \1[^]*?PAGE/i,"$1"),g+="<h3>"+e+"</h3>",g+="<table><th>TASK NAME</th><th>DATE LAST ACCOMP</th><th>DATE DUE</th>";for(var j=0;j<f.length;j++)c=f[j],d=new RegExp(c.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"i"),d.test(h[i])&&(b=h[i].replace(/(<\/?(TD|TR|TH)\/?>)|\n+/g," "),b=b.replace(/\s+/g," "),d=new RegExp(c+" \\w{4}[^]*?[A-Z]{2}[0-9]{2}","i"),b=b.match(d)[0],b=/\d\d [A-Z]{3} \d\d/g.test(b)?2===b.match(/\d\d [A-Z]{3} \d\d/g).length?"<td>"+b.match(/\d\d [A-Z]{3} \d\d/g)[0]+'</td><td class="due">'+b.match(/\d\d [A-Z]{3} \d\d/g)[1]+"</td>":(Window.alert('Error while trying to print dates. Search the code for "Number of dates found = "'),"Number of dates found = "+b.match(/\d\d [A-Z]{3} \d\d/g).length):"<td>no date found</td><td>no date found</td>",g+="<tr><td>"+c+"</td>"+b+"</tr>");g+="</table>"}document.getElementById("fileDisplayArea").innerHTML=colorize(g)}